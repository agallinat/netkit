<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to netkit • netkit</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to netkit">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">netkit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">Introduction to netkit</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to netkit</h1>
            
      

      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<p><strong>netkit</strong> is a lightweight, modular R package designed
to simplify the analysis and visualization of complex networks,
particularly in biological contexts such as protein–protein
interactions, gene co-expression, and signaling networks. However,
provided functions and analyses can theoretically be applied to any kind
of interaction network. It provides a user-friendly interface to explore
network topology, visualize annotated graphs, simulate signal diffusion,
and evaluate network robustness.</p>
<p>Key use cases include:</p>
<ul>
<li><p>Mapping metadata onto networks</p></li>
<li><p>Identifying hubs, bottlenecks, and communities</p></li>
<li><p>Simulating information flow within a network</p></li>
<li><p>Prioritizing seed nodes for targeted interventions</p></li>
<li><p>Visualizing networks with meaningful node/edge
annotations</p></li>
</ul>
<p>With a special scope to generate high-quality and interpretable
figures suitable for publication, most of the functions generate both
tabular results and diagnostic plots. The package also offers flexible
network visualization options that support node/edge metadata mapping,
dynamic sizing, and layout control.</p>
<p>The toolkit is built on <code>igraph</code>, but adds streamlined,
high-level functionality to perform common network analysis tasks with
minimal friction. All diagnostic plots are built on
<code>ggplot2</code>, allowing for flexible customization.</p>
<div class="section level2">
<h2 id="installation">0. Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p><strong>netkit</strong> can be installed from github, as follows:</p>
<pre><code><span><span class="co"># If not already installed:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install netkit from GitHub</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"agallinat/netkit"</span><span class="op">)</span></span></code></pre>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load netkit</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://agallinat.github.io/netkit">netkit</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="annotate-graphs">1. Annotate Graphs<a class="anchor" aria-label="anchor" href="#annotate-graphs"></a>
</h2>
<p>For this tutorial we will use two different synthetic graphs
generated using <code><a href="https://r.igraph.org/reference/sample_pa.html" class="external-link">igraph::sample_pa()</a></code> and
<code><a href="https://r.igraph.org/reference/sample_gnp.html" class="external-link">igraph::sample_gnp()</a></code> functions. We also generate two
<code>data.frame</code> objects containing simulated nodes’ and edges’
metadata to be included in the original graph.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate synthetic graphs</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/sample_pa.html" class="external-link">sample_pa</a></span><span class="op">(</span><span class="fl">100</span>, power <span class="op">=</span> <span class="fl">1.5</span>, directed <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://r.igraph.org/reference/gorder.html" class="external-link">vcount</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/sample_gnp.html" class="external-link">sample_gnp</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0.02</span>, directed <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://r.igraph.org/reference/gorder.html" class="external-link">vcount</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate nodes and edges metadata</span></span>
<span><span class="va">nodes_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>node <span class="op">=</span> <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">name</span>, </span>
<span>                         category <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">LETTERS</span>, <span class="fu"><a href="https://r.igraph.org/reference/gorder.html" class="external-link">vcount</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>                         score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/gorder.html" class="external-link">vcount</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/as_edgelist.html" class="external-link">as_edgelist</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="va">edges_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">edges</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, to <span class="op">=</span> <span class="va">edges</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, edge_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/gsize.html" class="external-link">ecount</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>For instance, this simulated metadata could represent gene expression
results, entity types, edge confidence scores, effect of the
interaction, or any type of information, that may be useful to include
as an <code>igraph</code> object. We can annotate an existing graph,
using the <code><a href="../reference/assign_attributes.html">assign_attributes()</a></code> function. Only matching nodes
and edges are updated. Warnings are issued when there are unmatched
entries.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://agallinat.github.io/netkit">netkit</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add metadata to an existing graph</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assign_attributes.html">assign_attributes</a></span><span class="op">(</span><span class="va">g</span>, nodes_table <span class="op">=</span> <span class="va">nodes_info</span>, edge_table <span class="op">=</span> <span class="va">edges_info</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/vertex_attr_names.html" class="external-link">vertex_attr_names</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "name"     "category" "score"</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/edge_attr_names.html" class="external-link">edge_attr_names</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "edge_score"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="network-visualization">2. Network Visualization<a class="anchor" aria-label="anchor" href="#network-visualization"></a>
</h2>
<p><code><a href="../reference/plot_Net.html">plot_Net()</a></code> is the main visualization function. It
supports size/color mapping of nodes and edges using existing nodes’
metadata. It also allows layout control.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># In the default plot, nodes' size is mapped to degree and edges' width to betweenness</span></span>
<span><span class="fu"><a href="../reference/plot_Net.html">plot_Net</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/plot-network-1.png" width="384"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Nodes size and edge with scalling factors can be modified at will. </span></span>
<span><span class="fu"><a href="../reference/plot_Net.html">plot_Net</a></span><span class="op">(</span><span class="va">g</span>, edge.width.factor <span class="op">=</span> <span class="fl">0.3</span>, node.size.factor <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/plot-network-2.png" width="384"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># And turned off</span></span>
<span><span class="fu"><a href="../reference/plot_Net.html">plot_Net</a></span><span class="op">(</span><span class="va">g</span>, node.degree.map <span class="op">=</span> <span class="cn">F</span>, edge.bw.map <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/plot-network-3.png" width="384"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Node colors can be mapped to existing nodes metadata</span></span>
<span><span class="fu"><a href="../reference/plot_Net.html">plot_Net</a></span><span class="op">(</span><span class="va">g</span>, color <span class="op">=</span> <span class="st">"score"</span>, node.degree.map <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/plot-network-4.png" width="384"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># For directed graphs, arrow sizes are also easily custimizable</span></span>
<span><span class="fu"><a href="../reference/plot_Net.html">plot_Net</a></span><span class="op">(</span><span class="va">g2</span>, edge.width.factor <span class="op">=</span> <span class="fl">0.5</span>, node.size.factor <span class="op">=</span> <span class="fl">2</span>, edge.arrow.size <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/plot-network-5.png" width="384"></p>
<p>Specific nodes can also be highlighted using the function
<code><a href="../reference/highlight_nodes.html">highlight_nodes()</a></code> and the nodes’ name. Highlighting method
(label, fill and/or outline) and colors can be customized at will.
Aditional arguments are passed to the <code><a href="../reference/plot_Net.html">plot_Net()</a></code>
function:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/highlight_nodes.html">highlight_nodes</a></span><span class="op">(</span><span class="va">g</span>, nodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"4"</span><span class="op">)</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"outline"</span>, <span class="st">"fill"</span><span class="op">)</span>,</span>
<span>                edge.width.factor <span class="op">=</span> <span class="fl">0.3</span>, node.degree.map <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/highlight-network-1.png" width="384"></p>
<p>Both functions (<code><a href="../reference/plot_Net.html">plot_Net()</a></code> and
<code><a href="../reference/highlight_nodes.html">highlight_nodes()</a></code>) also allow for layout control via
<code>layout</code> parameter. This accepts a coordinates matrix custom
or generated by any of the layout functions available in
<code>igraph</code> package. A special layout option has been
implemented in <code>netkit</code> package to display the network as a
horizontal tree (<code><a href="../reference/layout_horizontal_tree.html">layout_horizontal_tree()</a></code>). Which is
particularly useful to show hierarchical relationships.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_Net.html">plot_Net</a></span><span class="op">(</span><span class="va">g</span>, edge.width.factor <span class="op">=</span> <span class="fl">0.3</span>, node.size.factor <span class="op">=</span> <span class="fl">2</span>,</span>
<span>         layout <span class="op">=</span> <span class="fu"><a href="../reference/layout_horizontal_tree.html">layout_horizontal_tree</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="section level3">
<h3 id="topological-analysis">3. Topological Analysis<a class="anchor" aria-label="anchor" href="#topological-analysis"></a>
</h3>
</div>
<div class="section level3">
<h3 id="global-topology">3.1. Global topology<a class="anchor" aria-label="anchor" href="#global-topology"></a>
</h3>
<p>The core functions for a global network topology analysis are
<code><a href="../reference/plot_CCDF.html">plot_CCDF()</a></code>, which generates a plot of the
<strong>complementary cumulative degree distribution (CCDF)</strong>,
and <code>sumarize_graph_metrics()</code>, which calculates the
following parmeters for an input graph:</p>
<ul>
<li>Number of nodes and edges</li>
<li>Directed <code>TRUE/FALSE</code>
</li>
<li>Graph density</li>
<li>Diameter and average path length of the largest connected
component</li>
<li>Clustering coefficient (transitivity)</li>
<li>Degree assortativity</li>
<li>Average degree and betweenness centrality</li>
<li>Number of connected components and size of the largest connected
component</li>
<li>Number of single nodes</li>
<li>Algebraic connectivity (second-smallest Laplacian eigenvalue)</li>
<li>Degree entropy (Shannon entropy of the degree distribution)</li>
<li>Gini coefficient of node degrees</li>
<li>Modularity of the community structure (via Louvain algorithm)</li>
</ul>
<p>The function <code><a href="../reference/compare_networks.html">compare_networks()</a></code>, accepts two graphs as
input, and computes the same metrics on both, and their associated
(CCDF).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Global topology analysis</span></span>
<span><span class="fu"><a href="../reference/summarize_graph_metrics.html">summarize_graph_metrics</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Nodes Edges Is_directed Density Diameter Average_path_length</span></span>
<span><span class="co">#&gt; 1   100    99       FALSE    0.02       10            5.027273</span></span>
<span><span class="co">#&gt;   Clustering_coefficient Degree_assortativity Avg_degree Avg_betweenness</span></span>
<span><span class="co">#&gt; 1                      0           -0.4943885       1.98          199.35</span></span>
<span><span class="co">#&gt;   Components Single_nodes LCC_size LCC_percent Algebraic_connectivity</span></span>
<span><span class="co">#&gt; 1          1            0      100           1             0.01500655</span></span>
<span><span class="co">#&gt;   Degree_entropy Gini_degree Modularity</span></span>
<span><span class="co">#&gt; 1       1.504678   0.4341414  0.7809917</span></span>
<span></span>
<span><span class="co"># Complementary cumulative degree distribution</span></span>
<span><span class="co"># It optionally shows a power law reference distribution of chosen gamma.</span></span>
<span><span class="fu"><a href="../reference/plot_CCDF.html">plot_CCDF</a></span><span class="op">(</span><span class="va">g</span>, show_PL <span class="op">=</span> <span class="cn">TRUE</span>, PL_exponents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/topology-1.png" width="576"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Same analyses to compare two networks</span></span>
<span><span class="fu"><a href="../reference/compare_networks.html">compare_networks</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">g2</span><span class="op">)</span></span>
<span><span class="co">#&gt; $CCDF_plot</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/topology-2.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $global_topology</span></span>
<span><span class="co">#&gt;   Nodes Edges Is_directed   Density Diameter Average_path_length</span></span>
<span><span class="co">#&gt; 1   100    99       FALSE 0.0200000       10            5.027273</span></span>
<span><span class="co">#&gt; 2   100   183        TRUE 0.0369697        8            3.583333</span></span>
<span><span class="co">#&gt;   Clustering_coefficient Degree_assortativity Avg_degree Avg_betweenness</span></span>
<span><span class="co">#&gt; 1             0.00000000           -0.4943885       1.98          199.35</span></span>
<span><span class="co">#&gt; 2             0.03725598            0.1039542       3.66          117.80</span></span>
<span><span class="co">#&gt;   Components Single_nodes LCC_size LCC_percent Algebraic_connectivity</span></span>
<span><span class="co">#&gt; 1          1            0      100        1.00           1.500655e-02</span></span>
<span><span class="co">#&gt; 2          4            2       96        0.96           3.560702e-18</span></span>
<span><span class="co">#&gt;   Degree_entropy Gini_degree Modularity</span></span>
<span><span class="co">#&gt; 1       1.504678   0.4341414  0.7809917</span></span>
<span><span class="co">#&gt; 2       2.824170   0.2796721  0.4884589</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $similarity</span></span>
<span><span class="co">#&gt;   jaccard_similarity node_overlap edge_overlap</span></span>
<span><span class="co">#&gt; 1        0.003558719            1  0.003558719</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ks_test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  deg1 and deg2</span></span>
<span><span class="co">#&gt; D = 0.62, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="robustness-analyisis">3.2. Robustness Analyisis<a class="anchor" aria-label="anchor" href="#robustness-analyisis"></a>
</h3>
<p>The package implements <code><a href="../reference/robustness_analysis.html">robustness_analysis()</a></code> for
simulating network robustness under targeted or random node removal,
following the framework of <a href="https://www.nature.com/articles/35019019" class="external-link">Albert et al.,
2000</a>.</p>
<p>In this context, robustness refers to a network’s ability to maintain
its connectivity and functionality when nodes are removed — either
randomly (failures) or in a targeted manner (attacks). This distinction
is particularly relevant in biological networks, where random failures
may represent stochastic damage (e.g., mutations, degradation), while
targeted attacks can simulate inhibition of key regulatory nodes or drug
targets.</p>
<p>The function accepts the parameter <code>removal_strategy</code>
which defines the order of the nodes to be removed. It can be one of:
<code>"random"</code>, <code>"degree"</code>,
<code>"betweenness"</code>, or the name of a numeric vertex attribute.
Custom attributes are interpreted as priority scores (higher = removed
first). At each step, the function tracks the size of the largest
connected component, allowing visualization of how rapidly the network
fragments under each scenario. This analysis is useful to evaluate
network resilience and identify critical nodes whose disruption may
disproportionately affect system integrity.</p>
<p>If the removal strategy is set to <code>"random"</code> and
<code>n_reps &gt; 1</code>, a summarized data frame (with mean and SD)
is returned as summary.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Robustness analysis</span></span>
<span><span class="fu"><a href="../reference/robustness_analysis.html">robustness_analysis</a></span><span class="op">(</span><span class="va">g</span>, removal_strategy <span class="op">=</span> <span class="st">"betweenness"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $plot</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/robustness-1.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $all_results</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 50 × 6</span></span></span>
<span><span class="co">#&gt;      rep removed removed_frac lcc_size efficiency n_components</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1       1       0.010<span style="text-decoration: underline;">1</span>       54    0.107             17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1       2       0.020<span style="text-decoration: underline;">2</span>       20    0.058<span style="text-decoration: underline;">7</span>            23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1       4       0.040<span style="text-decoration: underline;">4</span>       18    0.041<span style="text-decoration: underline;">1</span>            37</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1       6       0.060<span style="text-decoration: underline;">6</span>        8    0.014<span style="text-decoration: underline;">0</span>            58</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1       8       0.080<span style="text-decoration: underline;">8</span>        7    0.013<span style="text-decoration: underline;">0</span>            58</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1      10       0.101         6    0.010<span style="text-decoration: underline;">3</span>            62</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1      12       0.121         4    0.007<span style="text-decoration: underline;">05</span>           67</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1      14       0.141         4    0.004<span style="text-decoration: underline;">92</span>           71</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1      16       0.162         3    0.003<span style="text-decoration: underline;">87</span>           72</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1      18       0.182         3    0.002<span style="text-decoration: underline;">56</span>           74</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 40 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $summary</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 50 × 6</span></span></span>
<span><span class="co">#&gt;      rep removed removed_frac lcc_size efficiency n_components</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1       1       0.010<span style="text-decoration: underline;">1</span>       54    0.107             17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1       2       0.020<span style="text-decoration: underline;">2</span>       20    0.058<span style="text-decoration: underline;">7</span>            23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1       4       0.040<span style="text-decoration: underline;">4</span>       18    0.041<span style="text-decoration: underline;">1</span>            37</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1       6       0.060<span style="text-decoration: underline;">6</span>        8    0.014<span style="text-decoration: underline;">0</span>            58</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1       8       0.080<span style="text-decoration: underline;">8</span>        7    0.013<span style="text-decoration: underline;">0</span>            58</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1      10       0.101         6    0.010<span style="text-decoration: underline;">3</span>            62</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1      12       0.121         4    0.007<span style="text-decoration: underline;">05</span>           67</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1      14       0.141         4    0.004<span style="text-decoration: underline;">92</span>           71</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1      16       0.162         3    0.003<span style="text-decoration: underline;">87</span>           72</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1      18       0.182         3    0.002<span style="text-decoration: underline;">56</span>           74</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 40 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $auc</span></span>
<span><span class="co">#&gt; $auc$lcc_size</span></span>
<span><span class="co">#&gt; [1] 0.04638982</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $auc$efficiency</span></span>
<span><span class="co">#&gt; [1] 0.03235174</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $auc$n_components</span></span>
<span><span class="co">#&gt; [1] 0.5862681</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="hubs">3.3. Hubs<a class="anchor" aria-label="anchor" href="#hubs"></a>
</h3>
<p><strong>Hub nodes</strong> are defined as nodes with a particularly
high degree and betweenness centrality. Using the function
<code><a href="../reference/find_hubs.html">find_hubs()</a></code>, we can identify these nodes using either
z-score or quantile thresholds for degree and betweenness centrality.
The function generates a diagnostic plot to visualize the classification
using a scatter plot with marginal histograms.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Hubs detection</span></span>
<span><span class="fu"><a href="../reference/find_hubs.html">find_hubs</a></span><span class="op">(</span><span class="va">g</span>, method <span class="op">=</span> <span class="st">"zscore"</span>, </span>
<span>          degree_threshold <span class="op">=</span> <span class="fl">2.5</span>, </span>
<span>          betweenness_threshold <span class="op">=</span> <span class="fl">1</span>,</span>
<span>          hub_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># to display hub nodes' label in the diagnostic plot</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/hubs-1.png" width="480"></p>
<pre><code><span><span class="co">#&gt; $plot</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "Hub nodes identified by method: zscore with Degree metric threshold = 2.5 and Betweenness metric threshold = 1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $result</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 × 6</span></span></span>
<span><span class="co">#&gt;    node  degree betweenness degree_metric betweenness_metric is_hub</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1          7      0.662          2.42               4.84  FALSE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2          3      0.543          0.977              4.08  FALSE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3          2      0.287          0.377              2.23  FALSE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4         14      0.298          3.73               2.31  TRUE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5         17      0.669          4.11               4.88  TRUE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6          4      0.079<span style="text-decoration: underline;">4</span>         1.44               0.424 FALSE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7          1      0             -<span style="color: #BB0000;">0.469</span>             -<span style="color: #BB0000;">0.358</span> FALSE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8         16      0.348          4.00               2.70  TRUE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9          2      0.020<span style="text-decoration: underline;">2</span>         0.377             -<span style="color: #BB0000;">0.153</span> FALSE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10         2      0.020<span style="text-decoration: underline;">2</span>         0.377             -<span style="color: #BB0000;">0.153</span> FALSE </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 90 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $graph</span></span>
<span><span class="co">#&gt; IGRAPH 5ed3cdb UN-- 100 99 -- Barabasi graph</span></span>
<span><span class="co">#&gt; + attr: name (g/c), power (g/n), m (g/n), zero.appeal (g/n), algorithm</span></span>
<span><span class="co">#&gt; | (g/c), name (v/c), category (v/c), score (v/n), is_hub (v/l),</span></span>
<span><span class="co">#&gt; | edge_score (e/n)</span></span>
<span><span class="co">#&gt; + edges from 5ed3cdb (vertex names):</span></span>
<span><span class="co">#&gt;  [1] 1 --2  1 --3  3 --4  2 --5  5 --6  6 --7  1 --8  4 --9  8 --10 5 --11</span></span>
<span><span class="co">#&gt; [11] 5 --12 12--13 5 --14 8 --15 6 --16 2 --17 14--18 4 --19 1 --20 5 --21</span></span>
<span><span class="co">#&gt; [21] 20--22 19--23 12--24 12--25 25--26 12--27 14--28 12--29 12--30 5 --31</span></span>
<span><span class="co">#&gt; [31] 4 --32 30--33 28--34 17--35 23--36 1 --37 12--38 22--39 5 --40 6 --41</span></span>
<span><span class="co">#&gt; [41] 5 --42 4 --43 8 --44 8 --45 8 --46 4 --47 4 --48 5 --49 10--50 5 --51</span></span>
<span><span class="co">#&gt; [51] 35--52 1 --53 8 --54 30--55 4 --56 12--57 5 --58 4 --59 28--60 46--61</span></span>
<span><span class="co">#&gt; + ... omitted several edges</span></span></code></pre>
<p>The diagnostic plot is generated using <code>ggplot2</code> with a
<code>ggExtra</code> layer. Additional <code>ggplot2</code> parameters
or layers should be added before the plot is rendered. For this reason,
the function includes the argument <code>gg_extra = list()</code> which
passes comma-separated <code>ggplot2</code> parameters and layers to the
plot before rendering, as follows:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First we need to load `ggplot2` library for</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Hubs detection plot customization.</span></span>
<span><span class="co"># Notice all arguments in `gg_extra` are in list format, separated with commas, not `+` signs (as usual for `ggplot2`)</span></span>
<span><span class="co"># To modify the color of the highlighted area in the plot, use the argument `focus_color`.</span></span>
<span><span class="va">hubs_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_hubs.html">find_hubs</a></span><span class="op">(</span><span class="va">g</span>, method <span class="op">=</span> <span class="st">"zscore"</span>, degree_threshold <span class="op">=</span> <span class="fl">2.5</span>, betweenness_threshold <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                         focus_color <span class="op">=</span> <span class="st">"purple"</span>, </span>
<span>                         gg_extra <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Hubs detection"</span><span class="op">)</span>,</span>
<span>                                         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hubs_result</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/hubs-2-1.png" width="480"></p>
</div>
<div class="section level3">
<h3 id="bottlenecks">3.4. Bottlenecks<a class="anchor" aria-label="anchor" href="#bottlenecks"></a>
</h3>
<p><strong>Bottlenecks</strong> are defined as nodes with a particularly
high betweenness centrality but low degree. Similarly to the
<code><a href="../reference/find_hubs.html">find_hubs()</a></code> function, we can use
<code><a href="../reference/find_bottlenecks.html">find_bottlenecks()</a></code> to identify these nodes. Either z-score
or quantile thresholds can be employed for degree and betweenness
centrality thresholding. The function generates a diagnostic plot to
visualize the classification using a scatter plot with marginal
histograms.</p>
<p>As in <code><a href="../reference/find_hubs.html">find_hubs()</a></code>, the function includes the argument
<code>gg_extra = list()</code> which passes comma-separated
<code>ggplot2</code> parameters and layers to the plot before rendering,
to allow full plot customization.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Bottlenecks detection</span></span>
<span><span class="fu"><a href="../reference/find_bottlenecks.html">find_bottlenecks</a></span><span class="op">(</span><span class="va">g</span>, </span>
<span>                 method <span class="op">=</span> <span class="st">"zscore"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="introduction_files/figure-html/bottlenecks-1.png" width="480"></p>
<pre><code><span><span class="co">#&gt; $plot</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "Bottlenecks identified by method: zscore with Degree metric threshold = -1 and Betweenness metric threshold = 1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $result</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 × 6</span></span></span>
<span><span class="co">#&gt;    node  degree betweenness degree_metric betweenness_metric is_bottleneck</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1          7      0.662          2.42               4.84  FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2          3      0.543          0.977              4.08  FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3          2      0.287          0.377              2.23  FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4         14      0.298          3.73               2.31  FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5         17      0.669          4.11               4.88  FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6          4      0.079<span style="text-decoration: underline;">4</span>         1.44               0.424 FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7          1      0             -<span style="color: #BB0000;">0.469</span>             -<span style="color: #BB0000;">0.358</span> FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8         16      0.348          4.00               2.70  FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9          2      0.020<span style="text-decoration: underline;">2</span>         0.377             -<span style="color: #BB0000;">0.153</span> FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10         2      0.020<span style="text-decoration: underline;">2</span>         0.377             -<span style="color: #BB0000;">0.153</span> FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 90 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $graph</span></span>
<span><span class="co">#&gt; IGRAPH 5ed3cdb UN-- 100 99 -- Barabasi graph</span></span>
<span><span class="co">#&gt; + attr: name (g/c), power (g/n), m (g/n), zero.appeal (g/n), algorithm</span></span>
<span><span class="co">#&gt; | (g/c), name (v/c), category (v/c), score (v/n), is_bottleneck (v/l),</span></span>
<span><span class="co">#&gt; | edge_score (e/n)</span></span>
<span><span class="co">#&gt; + edges from 5ed3cdb (vertex names):</span></span>
<span><span class="co">#&gt;  [1] 1 --2  1 --3  3 --4  2 --5  5 --6  6 --7  1 --8  4 --9  8 --10 5 --11</span></span>
<span><span class="co">#&gt; [11] 5 --12 12--13 5 --14 8 --15 6 --16 2 --17 14--18 4 --19 1 --20 5 --21</span></span>
<span><span class="co">#&gt; [21] 20--22 19--23 12--24 12--25 25--26 12--27 14--28 12--29 12--30 5 --31</span></span>
<span><span class="co">#&gt; [31] 4 --32 30--33 28--34 17--35 23--36 1 --37 12--38 22--39 5 --40 6 --41</span></span>
<span><span class="co">#&gt; [41] 5 --42 4 --43 8 --44 8 --45 8 --46 4 --47 4 --48 5 --49 10--50 5 --51</span></span>
<span><span class="co">#&gt; [51] 35--52 1 --53 8 --54 30--55 4 --56 12--57 5 --58 4 --59 28--60 46--61</span></span>
<span><span class="co">#&gt; + ... omitted several edges</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="calculate-roles">3.5. Calculate Roles<a class="anchor" aria-label="anchor" href="#calculate-roles"></a>
</h3>
<p>Beyond classical hubs and bottlenecks, the package implements the
function <code><a href="../reference/calculate_roles.html">calculate_roles()</a></code> for node role classification
based on within-module and between-module connectivity, as described by
<a href="https://www.nature.com/articles/nature03288" class="external-link">Guimerà &amp;
Amaral, 2005</a>, which defines nodes’ roles using two metrics:</p>
<ul>
<li><p><strong>Within-module degree z-score</strong>: measures how
well-connected a node is to others within its own module (i.e., local
hubness).</p></li>
<li><p><strong>Participation coefficient</strong>: quantifies how evenly
a node’s links are distributed across different modules, capturing its
inter-modular connectivity.</p></li>
</ul>
<p>Combining these dimensions allows the classification of nodes into
distinct structural roles — such as module hubs, connectors, or
peripheral nodes — providing insight into how individual elements
contribute to local and global network organization.</p>
<p>The function generates a classic <code>ggplot2</code> object, thus,
the resulting plot is fully customizable with <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Hubs detection</span></span>
<span><span class="fu"><a href="../reference/calculate_roles.html">calculate_roles</a></span><span class="op">(</span><span class="va">g</span>,</span>
<span>                label.size <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                label_region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R3"</span>, <span class="st">"R6"</span><span class="op">)</span><span class="op">)</span> <span class="co"># to display the label of nodes with roles 'R1' and 'R2' in the plot.</span></span>
<span><span class="co">#&gt; $plot</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/roles-1.png" width="480"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $roles_definitions</span></span>
<span><span class="co">#&gt;   Name                Description                       Condition</span></span>
<span><span class="co">#&gt; 1   R1 Ultra-peripheral (non-hub)             z &lt; 2.5 &amp; P &lt;= 0.05</span></span>
<span><span class="co">#&gt; 2   R2       Peripheral (non-hub)   z &lt; 2.5 &amp; 0.05 &lt; P &amp; P &lt;= 0.6</span></span>
<span><span class="co">#&gt; 3   R3          Non-hub connector    z &lt; 2.5 &amp; 0.6 &lt; P &amp; P &lt;= 0.8</span></span>
<span><span class="co">#&gt; 4   R4            Non-hub kinless               z &lt; 2.5 &amp; P &gt; 0.8</span></span>
<span><span class="co">#&gt; 5   R5             Provincial hub            z &gt;= 2.5 &amp; P &lt;= 0.25</span></span>
<span><span class="co">#&gt; 6   R6              Connector hub z &gt;= 2.5 &amp; 0.25 &lt; P &amp; P &lt;= 0.75</span></span>
<span><span class="co">#&gt; 7   R7                Kinless hub             z &gt;= 2.5 &amp; P &gt; 0.75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $result</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 98 × 6</span></span></span>
<span><span class="co">#&gt;    node  module       z     p role  stringsAsFactors</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1          7  2.72   0.245 R5    FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2          7  0.118  0.444 R2    FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3          7 -<span style="color: #BB0000;">0.532</span>  0.5   R2    FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4          1  3.60   0.133 R5    FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5          8  3.33   0.484 R6    FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6          3  1.57   0.375 R2    FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7          3 -<span style="color: #BB0000;">0.671</span>  0     R1    FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8          4  3.86   0.227 R5    FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9          1  0.043<span style="text-decoration: underline;">1</span> 0     R1    FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10         4  0.037<span style="text-decoration: underline;">5</span> 0     R1    FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 88 more rows</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="modules">3.6. Modules<a class="anchor" aria-label="anchor" href="#modules"></a>
</h3>
<p>The package also implements a function to identify
<strong>modules</strong> (communities) in a network using a variety of
community detection algorithms from the <code>igraph</code> package
(e.g., Louvain, Walktrap, Infomap). Optionally filters out small
modules, visualizes the detected modules, and returns induced subgraphs
for each module.</p>
<p>Additional parameters are passed through the <code><a href="../reference/plot_Net.html">plot_Net()</a></code>
function, allowing full customization of the network plot.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find modules</span></span>
<span><span class="fu"><a href="../reference/find_modules.html">find_modules</a></span><span class="op">(</span><span class="va">g</span>, </span>
<span>             method <span class="op">=</span> <span class="st">"louvain"</span>,</span>
<span>             edge.width.factor <span class="op">=</span> <span class="fl">0.3</span>, node.size.factor <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/modules-1.png" width="384"></p>
<pre><code><span><span class="co">#&gt; $module_table</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 × 2</span></span></span>
<span><span class="co">#&gt;    node  module</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4          2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5          3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8          5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9          2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10         5</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 90 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_modules</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $subgraphs</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "louvain"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $graph</span></span>
<span><span class="co">#&gt; IGRAPH 5ed3cdb UN-- 100 99 -- Barabasi graph</span></span>
<span><span class="co">#&gt; + attr: name (g/c), power (g/n), m (g/n), zero.appeal (g/n), algorithm</span></span>
<span><span class="co">#&gt; | (g/c), name (v/c), category (v/c), score (v/n), module (v/n), color</span></span>
<span><span class="co">#&gt; | (v/c), label (v/c), edge_score (e/n)</span></span>
<span><span class="co">#&gt; + edges from 5ed3cdb (vertex names):</span></span>
<span><span class="co">#&gt;  [1] 1 --2  1 --3  3 --4  2 --5  5 --6  6 --7  1 --8  4 --9  8 --10 5 --11</span></span>
<span><span class="co">#&gt; [11] 5 --12 12--13 5 --14 8 --15 6 --16 2 --17 14--18 4 --19 1 --20 5 --21</span></span>
<span><span class="co">#&gt; [21] 20--22 19--23 12--24 12--25 25--26 12--27 14--28 12--29 12--30 5 --31</span></span>
<span><span class="co">#&gt; [31] 4 --32 30--33 28--34 17--35 23--36 1 --37 12--38 22--39 5 --40 6 --41</span></span>
<span><span class="co">#&gt; [41] 5 --42 4 --43 8 --44 8 --45 8 --46 4 --47 4 --48 5 --49 10--50 5 --51</span></span>
<span><span class="co">#&gt; [51] 35--52 1 --53 8 --54 30--55 4 --56 12--57 5 --58 4 --59 28--60 46--61</span></span>
<span><span class="co">#&gt; + ... omitted several edges</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="information-flow">4. Information flow<a class="anchor" aria-label="anchor" href="#information-flow"></a>
</h2>
<p>Understanding how signals propagate across a network is a key step in
many systems-level analyses. Information flow analysis allows users to
identify nodes that are likely to be influenced by a stimulus or,
conversely, nodes that can best influence a desired set of targets. For
instance, in biological networks, <strong>information flow
analysis</strong> is key for pathway reconstruction, to associate nodes
(genes/proteins) to molecular functions or diseases, and to prioritize
candidate drugs for a given target.</p>
<div class="section level3">
<h3 id="network-diffusion">4.1. Network Diffusion<a class="anchor" aria-label="anchor" href="#network-diffusion"></a>
</h3>
<p>The functions <code><a href="../reference/network_diffusion.html">network_diffusion()</a></code> and
<code><a href="../reference/network_diffusion_with_pvalues.html">network_diffusion_with_pvalues()</a></code> simulate the spread of
information from a set of seed nodes across the network. Both functions
supports several diffusion models
(<code>"laplacian", "heat", "rwr"</code>) and computes the propagated
signal to every node in the network.</p>
<p><code><a href="../reference/network_diffusion_with_pvalues.html">network_diffusion_with_pvalues()</a></code> is an extension of
<code><a href="../reference/network_diffusion.html">network_diffusion()</a></code> that assesses the statistical
significance of diffusion scores by comparing them to a null
distribution obtained via permutation testing (random seed sets of the
same size).</p>
<p>These tools are useful for identifying nodes most impacted by a set
of sources, such as disease genes, drug targets, or signaling
proteins.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Diffusion analysis</span></span>
<span><span class="co"># Select random genes as seed nodes</span></span>
<span><span class="va">seed_nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/vertex_attr.html" class="external-link">vertex_attr</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">"name"</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/network_diffusion.html">network_diffusion</a></span><span class="op">(</span><span class="va">g</span>, seed_nodes <span class="op">=</span> <span class="va">seed_nodes</span>, method <span class="op">=</span> <span class="st">"laplacian"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 × 2</span></span></span>
<span><span class="co">#&gt;    node   score</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 44    0.865 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 79    0.865 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 87    0.850 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 25    0.677 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 41    0.647 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 26    0.224 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 86    0.214 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8     0.093<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 6     0.086<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 4     0.051<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 90 more rows</span></span></span>
<span></span>
<span><span class="fu"><a href="../reference/network_diffusion_with_pvalues.html">network_diffusion_with_pvalues</a></span><span class="op">(</span><span class="va">g</span>, seed_nodes <span class="op">=</span> <span class="va">seed_nodes</span>, method <span class="op">=</span> <span class="st">"laplacian"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running 1000 permutations with 5 random seed nodes each (parallelized)...</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 × 4</span></span></span>
<span><span class="co">#&gt;    node   score p_empirical stringsAsFactors</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 44    0.865     0.000<span style="text-decoration: underline;">999</span> FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 79    0.865     0.000<span style="text-decoration: underline;">999</span> FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 87    0.850     0.000<span style="text-decoration: underline;">999</span> FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 25    0.677     0.000<span style="text-decoration: underline;">999</span> FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 41    0.647     0.000<span style="text-decoration: underline;">999</span> FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 26    0.224     0.000<span style="text-decoration: underline;">999</span> FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 86    0.214     0.000<span style="text-decoration: underline;">999</span> FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 6     0.086<span style="text-decoration: underline;">7</span>    0.000<span style="text-decoration: underline;">999</span> FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 12    0.042<span style="text-decoration: underline;">3</span>    0.000<span style="text-decoration: underline;">999</span> FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 7     0.022<span style="text-decoration: underline;">5</span>    0.000<span style="text-decoration: underline;">999</span> FALSE           </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 90 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reverse-network-diffusion">4.2. Reverse Network Diffusion<a class="anchor" aria-label="anchor" href="#reverse-network-diffusion"></a>
</h3>
<p>The function <code><a href="../reference/greedy_seed_selection.html">greedy_seed_selection()</a></code> implements a
<strong>greedy algorithm</strong> to select a set of seed nodes (of size
<em>k</em>) that maximize the total diffusion signal over a given set of
<strong>target nodes</strong>.</p>
<p>This reverse diffusion approach can be thought of as solving the
inverse problem: <em>Given a set of nodes I want to affect, which
upstream nodes (seeds) should I perturb to maximally reach
them?</em></p>
<p>This method is especially relevant in contexts like:</p>
<ul>
<li><p>Designing combinatorial interventions to target a disease
module.</p></li>
<li><p>Optimizing signal propagation to modulate a known gene
signature.</p></li>
<li><p>Identifying minimal upstream regulators of observed
phenotypes.</p></li>
</ul>
<p>The function also includes the optional argument
<code>candidate_nodes</code>, a character vector of eligible nodes’
names to be considered as seeds. If <code>NULL</code> (default), all
non-target nodes are used.</p>
<p>By simulating and optimizing diffusion iteratively,
<code><a href="../reference/greedy_seed_selection.html">greedy_seed_selection()</a></code> helps prioritize actionable nodes
in large and complex networks.</p>
<p><strong>Note</strong>: <em>Reverse diffusion</em> is a
computationally hard problem, as testing all possible combinations of
seed nodes is combinatorially explosive -even in small networks-. The
function solves this problem with a greedy algorithm, in which the node
that most increases the total diffusion signal over the target nodes is
added in each iteration (one at a time). This is an heuristic approach
that while does not guarantee the absolute best seed set, it performs
very well in real-world networks and lapses a reasonable time, making it
ideal for exploratory and applied analyses.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select random genes as target nodes</span></span>
<span><span class="va">target_nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/vertex_attr.html" class="external-link">vertex_attr</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">"name"</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/greedy_seed_selection.html">greedy_seed_selection</a></span><span class="op">(</span><span class="va">g</span>, target_nodes <span class="op">=</span> <span class="va">target_nodes</span>, k <span class="op">=</span> <span class="fl">20</span>, method <span class="op">=</span> <span class="st">"laplacian"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $selected_seeds</span></span>
<span><span class="co">#&gt;  [1] "61" "99" "35" "6"  "4"  "5"  "52" "16" "17" "41" "8"  "2"  "32" "43" "47"</span></span>
<span><span class="co">#&gt; [16] "48" "56" "59" "64" "87"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $final_target_score</span></span>
<span><span class="co">#&gt; [1] 0.9790991</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $scores_at_each_step</span></span>
<span><span class="co">#&gt;  [1] 0.1719920 0.3439840 0.5033102 0.6487288 0.6996954 0.7497938 0.7956516</span></span>
<span><span class="co">#&gt;  [8] 0.8333527 0.8639716 0.8867701 0.9057855 0.9148409 0.9228732 0.9309054</span></span>
<span><span class="co">#&gt; [15] 0.9389377 0.9469700 0.9550023 0.9630345 0.9710668 0.9790991</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $plot</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/reverse-diffusion-1.png" width="576"></p>
<p>The generated plot is also a <code>ggplot2</code> object, and thus,
fully customizable.</p>
</div>
</div>
<div class="section level2">
<h2 id="credits-and-contributions">5. Credits and Contributions<a class="anchor" aria-label="anchor" href="#credits-and-contributions"></a>
</h2>
<p><code>netkit</code> has been developed, and is mantained, by Alex
Gallinat, PhD.</p>
<p>Contributions are welcome! If you’d like to report a bug, suggest a
feature, or improve documentation, please open an issue or submit a pull
request at:</p>
<p><a href="https://github.com/agallinat/netkit/issues" class="external-link uri">https://github.com/agallinat/netkit/issues</a></p>
<p>For larger changes, feel free to open a discussion first.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alex Gallinat.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
